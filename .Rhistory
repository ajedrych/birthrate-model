########################### FIRST MODEL ###########################
#MODEL 1
model1=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
women_working + men_working + median_house_price + house_ratio + houses_area_pc +
avg_people_per_house + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + children + nursery_places + doctors+ urbanisation_rate + bus_stops, data=df1)
summary(model1)
stargazer(model1, type="text", align= TRUE, style="default", df=FALSE)
stargazer(model1, type="text", align= TRUE, style="default", df=FALSE)
df1$nurseryxchildren=df1$nursery_places*df1$children
df1$education_expenditurexchildren=df1$education_expenditure*df1$children
df1$houses_area_pc_2 = df1$houses_area_pc**2
summary(model1)
df1$nurseryxchildren=df1$nursery_places*df1$children
df1$education_expenditurexchildren=df1$education_expenditure*df1$children
df1$houses_area_pc_2 = df1$houses_area_pc**2
##################################################################
########################### NEXT MODEL ###########################
#MODEL 2 - ADD INTERACTONS AND VARIABLE^2
model2=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
women_working + men_working + median_house_price + house_ratio + houses_area_pc + houses_area_pc_2 +
avg_people_per_house + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + children + nursery_places + doctors+ urbanisation_rate + bus_stops +
nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model2)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 3 - LOG FOR AVG_SALARY, UNEMPLOYMENT_RATE AND MEDIAN_HOUSE_PRICE
model3=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + ln_avg_salary +
women_working + men_working + ln_median_house_price + house_ratio + houses_area_pc + houses_area_pc_2 +
avg_people_per_house + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + children + nursery_places + doctors+ urbanisation_rate + bus_stops +
nurseryxchildren + education_expenditurexchildren, data=df1)
df1$ln_unemployment_rate = log(df1$unemployment_rate)
df1$ln_avg_salary = log(df1$avg_salary)
df1$ln_median_house_price = log(df1$median_house_price)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 3 - LOG FOR AVG_SALARY, UNEMPLOYMENT_RATE AND MEDIAN_HOUSE_PRICE
model3=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + ln_avg_salary +
women_working + men_working + ln_median_house_price + house_ratio + houses_area_pc + houses_area_pc_2 +
avg_people_per_house + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + children + nursery_places + doctors+ urbanisation_rate + bus_stops +
nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model3)
summary(model3)
summary(model3)
linearHypothesis(model=model3, c("covid19_quarantine=0"))
linearHypothesis(model=model3, c("covid19_quarantine=0", "avg_people_per_house=0"))
linearHypothesis(model=model3, c("covid19_quarantine=0", "avg_people_per_house=0", "nurseryxchildren=0"))
#R^2 = 0.7739
#adj. r^2 = 0.7558 better
linearHypothesis(model=model3, c("covid19_quarantine=0", "avg_people_per_house=0", "nurseryxchildren=0"))
##################################################################
########################### NEXT MODEL ###########################
#MODEL 4 - REMOVE COVID19_QUARANTINE AND AVG_PEOPLE_PER_HOUSE
model4=lm(ln_birth_rate~covid19_cases + covid19_deaths + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + ln_avg_salary +
women_working + men_working + ln_median_house_price + house_ratio + houses_area_pc + houses_area_pc_2 +
education_expenditure + health_expenditure + social_expenditure +
family_expenditure + children + nursery_places + doctors+ urbanisation_rate + bus_stops +
nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model4)
linearHypothesis(model=model4, c("nurseryxchildren=0"))
linearHypothesis(model=model4, c("nurseryxchildren=0", "women_working=0"))
##################################################################
########################### NEXT MODEL ###########################
#MODEL 4 - REMOVE COVID19_QUARANTINE, AVG_PEOPLE_PER_HOUSEAND NURSERYXCHILDREN
model4=lm(ln_birth_rate~covid19_cases + covid19_deaths + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + ln_avg_salary +
women_working + men_working + ln_median_house_price + house_ratio + houses_area_pc + houses_area_pc_2 +
education_expenditure + health_expenditure + social_expenditure +
family_expenditure + children + nursery_places + doctors+ urbanisation_rate + bus_stops +
education_expenditurexchildren, data=df1)
summary(model4)
summary(model4)
linearHypothesis(model=model4, c("women_working=0"))
linearHypothesis(model=model4, c("women_working=0","houses_area_pc_2=0"))
linearHypothesis(model=model4, c("women_working=0","houses_area_pc_2=0", "urbanisation_rate=0"))
linearHypothesis(model=model4, c("women_working=0","houses_area_pc_2=0", "urbanisation_rate=0",
"houses_area_pc=0"))
linearHypothesis(model=model4, c("women_working=0","houses_area_pc_2=0", "urbanisation_rate=0",
"houses_area_pc=0", "budget_reve_pc=0"))
resettest(model1, power=2:3, type="fitted")
linearHypothesis(model=model4, c("women_working=0","houses_area_pc_2=0", "urbanisation_rate=0",
"houses_area_pc=0", "budget_reve_pc=0", "covid19_cases=0"))
linearHypothesis(model=model4, c("women_working=0","houses_area_pc_2=0", "urbanisation_rate=0",
"houses_area_pc=0", "budget_reve_pc=0", "covid19_cases=0",
"education_expenditure=0"))
linearHypothesis(model=model4, c("women_working=0","houses_area_pc_2=0", "urbanisation_rate=0",
"houses_area_pc=0", "budget_reve_pc=0", "covid19_cases=0",
"education_expenditure=0", "femininity_ratio=0"))
linearHypothesis(model=model4, c("women_working=0","houses_area_pc_2=0", "urbanisation_rate=0",
"houses_area_pc=0", "budget_reve_pc=0", "covid19_cases=0",
"education_expenditure=0", "femininity_ratio=0", "nursery_places=0"))
##################################################################
########################### NEXT MODEL ###########################
#MODEL 5 - REMOVE
model5=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_avg_salary + men_working + ln_median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + doctors + bus_stops +
education_expenditurexchildren, data=df1)
summary(model5)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 5 - REMOVE
model5=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
men_working + ln_median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + doctors + bus_stops +
education_expenditurexchildren, data=df1)
summary(model5)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 5 - REMOVE
model5=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
men_working + ln_median_house_price + health_expenditure +
social_expenditure + family_expenditure + children + doctors + bus_stops +
education_expenditurexchildren, data=df1)
summary(model5)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 5 - REMOVE
model5=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + health_expenditure +
social_expenditure + family_expenditure + children + doctors + bus_stops +
education_expenditurexchildren, data=df1)
summary(model5)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 5 - REMOVE
model5=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + health_expenditure +
social_expenditure + family_expenditure + children + doctors + bus_stops, data=df1)
summary(model5)
resettest(model5, power=2:3, type="fitted")
resettest(model5, power=2:3, type="regressor")
bptest(model5, studentize=TRUE)
jarque.bera.test(model5$residuals)
dwtest(model5)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 5 - REMOVE VARIABLE JOINTLY INSIGNIFICANT FROM GETS
model5=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_avg_salary + men_working + ln_median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + doctors + bus_stops +
education_expenditurexchildren, data=df1)
summary(model5)
linearHypothesis(model=model4, c("ln_avg_salary=0", "health_expenditure=0"))
linearHypothesis(model=model4, c("ln_avg_salary=0"))
##################################################################
########################### NEXT MODEL ###########################
#MODEL 5 - REMOVE VARIABLE JOINTLY INSIGNIFICANT FROM GETS
model5=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_avg_salary + men_working + ln_median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + doctors + bus_stops +
education_expenditurexchildren, data=df1)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 5 - REMOVE VARIABLE JOINTLY INSIGNIFICANT FROM GETS
model5=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_avg_salary + men_working + ln_median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + doctors + bus_stops +
education_expenditurexchildren, data=df1)
summary(model5)
linearHypothesis(model=model5, c("ln_avg_salary=0"))
linearHypothesis(model=model5, c("ln_avg_salary=0", "health_expenditure=0"))
linearHypothesis(model=model5, c("ln_avg_salary=0", "health_expenditure=0", "house_ratio=0"))
##################################################################
########################### NEXT MODEL ###########################
#MODEL 5 - REMOVE VARIABLE JOINTLY INSIGNIFICANT FROM GETS
model5=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
men_working + ln_median_house_price + house_ratio +
social_expenditure + family_expenditure + children + doctors + bus_stops +
education_expenditurexchildren, data=df1)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 6 - REMOVE VARIABLE JOINTLY INSIGNIFICANT FROM GETS
model6=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
men_working + ln_median_house_price + house_ratio +
social_expenditure + family_expenditure + children + doctors + bus_stops +
education_expenditurexchildren, data=df1)
summary(model6)
linearHypothesis(model=model6, c("house_ratio=0"))
linearHypothesis(model=model6, c("house_ratio=0", "men_working=0"))
##################################################################
########################### NEXT MODEL ###########################
#MODEL 6 - REMOVE VARIABLE JOINTLY INSIGNIFICANT FROM GETS
model6=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops +
education_expenditurexchildren, data=df1)
summary(model6)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 7 - REMOVE interaction because of her insignificance
model6=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops, data=df1)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 7 - REMOVE interaction because of her insignificance
model7=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops, data=df1)
summary(model7)
resettest(model7, power=2:3, type="fitted")
resettest(model5, power=2:3, type="regressor")
resettest(model7, power=2:3, type="regressor")
bptest(model7, studentize=TRUE)
plot(model7, 1) #residuals vs fitted
par(mfrow=(1,1))
par(mfrow=c(1,1))
plot(model7, 1) #residuals vs fitted
plot(model7, 2) #normal q-q
plot(model7, 3) #scale-location
plot(model7, 4) #cook's distance
plot(model7, 5) #residuals vs leverage
plot(model7, 6) #cook's dist vs leverage
jarque.bera.test(model7$residuals)
dwtest(model7)
#breuscha godfreya
bgtest(model7)
##########################################################################
#WSPÓŁLINIOWOŚĆ
# jesli VIF > 10, to zmienna objasniajaca jest współliniowa
vif(model7)
###################################################################
########################### FINAL MODEL ###########################
#MODEL 7 - REMOVE interaction because of her insignificance
model7=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure  + doctors + bus_stops, data=df1)
summary(model7)
plot(rstandard(model7))
plot(rstudent(model7))
plot(dffits(model7))
matplot(dfbetas(model7))
lines(sqrt(cooks.distance(model7)))
lines(sqrt(cooks.distance(model7)))
kor_subset<-cor(df1_subset)
# STANDARYZOWANE RESZTY (OUTLIERS)
# gdy ich wartości bezwględne > 2 to obserwacje nietypowe
rstandard(model5)[abs(rstandard(model5)) > 2]
plot(model5, which=4, cook.levels=cutoff)
lines(sqrt(cooks.distance(model7)))
###################################################################
########################### FINAL MODEL ###########################
#MODEL 7 - REMOVE interaction because of her insignificance
model7=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops, data=df1)
summary(model7)
df1_subset <- df1[,c("ln_birth_rate", "covid19_deaths", "marriage_rate", "divorce_rate",
"ln_unemployment_rate", "women_reproductive", "ln_median_house_price",
"social_expenditure", "family_expenditure", "doctors", "bus_stops")]
summary(df1_subset)
# CORRELATION PLOT MODEL 5
par(mfrow=c(1,1))
library(corrplot)
kor_subset<-cor(df1_subset)
corrplot(kor_subset, method="circle")
###################################################################
########################### FINAL MODEL ###########################
#MODEL 7 - REMOVE interaction because of her insignificance
model7=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops, data=df1)
df1_subset <- df1[,c("ln_birth_rate", "covid19_deaths", "marriage_rate", "divorce_rate",
"ln_unemployment_rate", "women_reproductive", "ln_median_house_price",
"social_expenditure", "family_expenditure","children", "doctors", "bus_stops")]
summary(df1_subset)
# CORRELATION PLOT MODEL 5
par(mfrow=c(1,1))
library(corrplot)
kor_subset<-cor(df1_subset)
corrplot(kor_subset, method="circle")
leveragePlots(model7)
describe(df1_subset[175,])
which.max(dzwignie)
dzwignie<-hatvalues(model7)
which.max(dzwignie)
# STANDARYZOWANE RESZTY (OUTLIERS)
# gdy ich wartości bezwględne > 2 to obserwacje nietypowe
rstandard(model7)[abs(rstandard(model7)) > 2]
#ODLEGLOSC COOKA (OBSERWACJE WPLYWOWE)
par(mfrow=c(1,1))
cutoff <- 4/((nrow(df1)))
plot(model7, which=4, cook.levels=cutoff)
library("lmtest")
library("sandwich")
NeweyWest(model7, lag=5, prewhite=FALSE)
autocorr = coeftest(model7, vcov=NeweyWest(model7, lag=5, prewhite=FALSE))
show(autocorr)
stargazer(model7, autocorr, type="text", df=FALSE)
###################################################################
########################### FINAL MODEL ###########################
#MODEL 7 - REMOVE interaction because of her insignificance
model7=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops +ln_avg_salary, data=df1)
summary(model7)
###################################################################
########################### FINAL MODEL ###########################
#MODEL 7 - REMOVE interaction because of her insignificance
model7=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops, data=df1)
summary(model7)
plotNormalHistogram(df1$covid19_deaths, prob = FALSE,
main = "covid19_deaths and normal distribution",
linecol = "red",
length = 1000)
jarque.bera.test(df1$covid19_deaths)
describe(df1$covid19_deaths)
plotNormalHistogram(df1$marriage_rate, prob = FALSE,
main = "marriage_rate and normal distribution",
linecol = "red",
length = 1000)
jarque.bera.test(df1$marriage_rate) #p-value < 0.05, I reject H0 about normal distribution
describe(marriage_rate)
describe(df1$marriage_rate)
plotNormalHistogram(df1$marriage_rate, prob = FALSE,
main = "marriage_rate and normal distribution",
linecol = "red",
length = 1000)
plotNormalHistogram(df1$divorce_rate, prob = FALSE,
main = "divorce_rate and normal distribution",
linecol = "red",
length = 1000)
describe(df1$divorce_rate)
jarque.bera.test(df1$divorce_rate) #p-value < 0.05, I reject H0 about normal distribution
###################################################################
########################### FIRST MODEL ###########################
#MODEL 1
model1=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
women_working + men_working + median_house_price + house_ratio + houses_area_pc +
avg_people_per_house + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + children + nursery_places + doctors+ urbanisation_rate + bus_stops, data=df1)
summary(model1)
df1$nurseryxchildren=df1$nursery_places*df1$children
df1$education_expenditurexchildren=df1$education_expenditure*df1$children
df1$houses_area_pc_2 = df1$houses_area_pc**2
##################################################################
########################### NEXT MODEL ###########################
#MODEL 2 - ADD INTERACTONS AND VARIABLE^2
model2=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
women_working + men_working + median_house_price + house_ratio + houses_area_pc + houses_area_pc_2 +
avg_people_per_house + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + children + nursery_places + doctors+ urbanisation_rate + bus_stops +
nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model2)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 3 - LOG FOR AVG_SALARY, UNEMPLOYMENT_RATE AND MEDIAN_HOUSE_PRICE
model3=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + ln_avg_salary +
women_working + men_working + ln_median_house_price + house_ratio + houses_area_pc + houses_area_pc_2 +
avg_people_per_house + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + children + nursery_places + doctors+ urbanisation_rate + bus_stops +
nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model3)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 5 - REMOVE VARIABLE JOINTLY INSIGNIFICANT FROM GETS
model5=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_avg_salary + men_working + ln_median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + doctors + bus_stops +
education_expenditurexchildren, data=df1)
summary(model5)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 6 - REMOVE VARIABLE JOINTLY INSIGNIFICANT FROM GETS
model6=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
men_working + ln_median_house_price + house_ratio +
social_expenditure + family_expenditure + children + doctors + bus_stops +
education_expenditurexchildren, data=df1)
summary(model6)
###################################################################
########################### FINAL MODEL ###########################
#MODEL 7 - REMOVE interaction because of her insignificance
model7=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops, data=df1)
summary(model7)
resettest(model7, power=2:3, type="fitted")
resettest(model7, power=2:3, type="regressor")
bptest(model7, studentize=TRUE)
par(mfrow=(2,2))
plot(model7)
par(mfrow=c(2,2))
plot(model7)
hist(model7$residuals)
plotNormalHistogram(model7$residuals, prob = FALSE,
main = "residuals and normal distribution",
linecol = "red",
length = 1000)
par(mfrow=c(1,1))
plotNormalHistogram(model7$residuals, prob = FALSE,
main = "residuals and normal distribution",
linecol = "red",
length = 1000)
stargazer(model1, model2, model3, model5, model6,model7, type="text", align= TRUE, style="default", df=TRUE)
stargazer(model1, type="text", align= TRUE, style="default", df=FALSE)
stargazer(model1, type="text", align= TRUE, style="default", df=FALSE)
stargazer(model2, type="text", align= TRUE, style="default", df=FALSE)
stargazer(model3, model7, type="text", align= TRUE, style="default", df=TRUE)
resettest(model7, power=2:3, type="fitted")
resettest(model7, power=2:3, type="regressor")
d<-density(model7$residuals)
plot(d,main='Residual KDE Plot',xlab='Residual value')
lot(ecdf(model7$residuals))
plot(ecdf(model7$residuals))
main='Residual KDE Plot'
plot(d,main='Residual KDE Plot',xlab='Residual value')
plot(ecdf(model7$residuals), main='Residual KDE Plot')
plot(ecdf(model7$residuals), main='Residual Empirical CDF')
shapiro.test(model7$residuals)
dwtest(model7)
#breuscha godfreya
bgtest(model7)
library("lmtest")
library("sandwich")
NeweyWest(model7, lag=5, prewhite=FALSE)
autocorr = coeftest(model7, vcov=NeweyWest(model7, lag=5, prewhite=FALSE))
show(autocorr)
stargazer(model7, autocorr, type="text", df=FALSE)
stargazer(model7, autocorr, type="text", df=FALSE)
##########################################################################
#WSPÓŁLINIOWOŚĆ
# jesli VIF > 10, to zmienna objasniajaca jest współliniowa
vif(model7)
df1_subset <- df1[,c("ln_birth_rate", "covid19_deaths", "marriage_rate", "divorce_rate",
"ln_unemployment_rate", "women_reproductive", "ln_median_house_price",
"social_expenditure", "family_expenditure","children", "doctors", "bus_stops")]
summary(df1_subset)
# CORRELATION PLOT MODEL 7
par(mfrow=c(1,1))
kor_subset<-cor(df1_subset)
corrplot(kor_subset, method="circle")
summary(model7)
leveragePlots(model7)
stargazer(as.data.frame(df1_subset), type = "text")
stargazer(as.data.frame(df1_subset), type = "text")
# STANDARYZOWANE RESZTY (OUTLIERS)
# gdy ich wartości bezwględne > 2 to obserwacje nietypowe
rstandard(model7)[abs(rstandard(model7)) > 2]
df_out <- df1[c(1:28, 30:178, 180:344, 346:),]
df_out <- df1[-c(19,179,345),]
model_out=lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops, data=df_out)
summary(model_out)
stargazer(model7, model_out, type="text", align= TRUE, style="default", df=TRUE)
stargazer(model7, model_out, type="text", align= TRUE, style="default", df=TRUE)
stargazer(model7, model_out, type="text", align= TRUE, style="default", df=TRUE, object.names = TRUE,
column.labels = c("model finalny", "model bez outlierów"))
stargazer(model7, model_out, type="text", align= TRUE, style="default", df=TRUE,
column.labels = c("model finalny", "model bez outlierów"))
stargazer(model7, model_out, type="text", align= TRUE, style="default", df=TRUE,
column.labels = c("wersja finalna", "wersja bez outlierów"))
stargazer(model7, model_out, type="text", align= TRUE, style="default", df=TRUE,
column.labels = c("wersja finalna", "wersja bez outlierów"))
stargazer(model7, autocorr, type="text", df=FALSE, column.labels = c("wersja finalna", "Estymator Neweya-Westa4"))
stargazer(model7, autocorr, type="text", df=FALSE, column.labels = c("wersja finalna", "Estymator Neweya-Westa"))
stargazer(model7, autocorr, type="text", df=FALSE, column.labels = c("wersja finalna", "estymator Neweya-Westa"))
stargazer(model3, model7, type="text", align= TRUE, style="default", df=TRUE, column.labels = c("wersja przejściowa", "wersja finalna"))
summary(model7)
model_gls=gls(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops, data=df1)
library("car")
model_gls=gls(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops, data=df1)
model7.weights <- 1 / lm(abs(model7$residuals) ~ model7$fitted.values)$fitted.values^2
model7.lmw <- lm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops,
data = df1,
weights = model7.weights)
summary.lm(model7.lmw)$coefficients
summary(model7.lmw)
model_glm=glm(ln_birth_rate~ covid19_deaths + marriage_rate + divorce_rate + ln_unemployment_rate + women_reproductive +
ln_median_house_price + social_expenditure + family_expenditure + children + doctors + bus_stops, data=df1)
summary(model_glm)
stargazer(model7, model_glm, model7.lmw type="text", align= TRUE, style="default", df=TRUE, column.labels = c("MNK", "SUMNK", "WMNK"))
stargazer(model7, model_glm, model7.lmw, type="text", align= TRUE, style="default", df=TRUE, column.labels = c("MNK", "SUMNK", "WMNK"))
stargazer(model7, model_glm, model7.lmw, type="text", align= TRUE, style="default", df=TRUE, column.labels = c("MNK", "SUMNK", "WMNK"))
jarque.bera.test(df1$doctors) #p-value < 0.05, I reject H0 about normal distribution
df1$ln_doctors = log(df1$doctors)
jarque.bera.test(df1$ln_doctors) #p-value < 0.05, but p-value is higher
plotNormalHistogram(df1$doctors, prob = FALSE,
main = "doctors and normal distribution",
linecol = "red",
length = 1000)
describe(df1$doctors)
jarque.bera.test(df1$women_reproductive) #p-value > 0.05
describe(df1$women_reproductive)
jarque.bera.test(df1$social_expenditure) #p-value < 0.05, I reject H0 about normal distribution
plotNormalHistogram(df1$social_expenditure, prob = FALSE,
main = "social_expenditure and normal distribution",
linecol = "red",
length = 1000)
describe(df1$social_expenditure)
jarque.bera.test(df1$family_expenditure) #p-value < 0.05, I reject H0 about normal distribution
describe(df1$family_expenditure)
plotNormalHistogram(df1$family_expenditure, prob = FALSE,
main = "family_expenditure and normal distribution",
linecol = "red",
length = 1000)
linearHypothesis(model=model7, c("covid19_deaths=0", "ln_unemployment_rate=0", "women_reproductive=0"))
# wydatki na dzieci
linearHypothesis(model=model7, c("social_expenditure=0", "family_expenditure=0"))
#cena mieszkan
linearHypothesis(model=model7, c("median_house_price-0"))
#cena mieszkan
linearHypothesis(model=model7, c("median_house_price=0"))
#cena mieszkan
linearHypothesis(model=model7, c("ln_median_house_price=0"))
