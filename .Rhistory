options(scipen = 999)
#LOAD DATA
df <- read_excel("baza_ekon.xlsx")
View(df)
#DELETE NA
df1<-na.omit(df)
summary(df)
# STATISTICS TABLE
library("stargazer")
# CORRELATION PLOT
library(corrplot)
kor<-cor(df)
corrplot(kor, method="circle")
# STATISTICS TABLE
library("stargazer")
stargazer(as.data.frame(df), type = "text")
library(rcompanion)
par(mfrow=c(1,2))
plotNormalHistogram(df1$birth_rate, prob = FALSE,
main = "birth_rate and normal distribution",
linecol = "red",
length = 1000)
df1$ln_birth_rate = log(df1$birth_rate)
plotNormalHistogram(df1$ln_birth_rate, prob = FALSE,
main = "ln_birth_rate and normal distribution",
linecol = "red",
length = 1000)
summary(df1$birth_rate)
stargazer(jarque.bera.test(df1$birth_rate), type = "text")
library("tseries")
stargazer(jarque.bera.test(df1$birth_rate), type = "text")
jarque.bera.test(df1$birth_rate) #p-value < 0.05, I reject H0 about normal distribution of birth_rate
jarque.bera.test(df1$ln_birth_rate) #p-value > 0.05; no grounds for rejecting H0 about normal distribution of ln_birth_rate
install.packages("ggthemes")
library("ggthemes")
ggplot( data.frame(df1$birth_rate), aes(y=df1$birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej birth_rate") +
xlab("")
ggplot( data.frame(df1$ln_birth_rate), aes(y=df1$ln_birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej ln_birth_rate") +
xlab("")
ggplot( data.frame(df1$birth_rate), aes(y=df1$birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej birth_rate") +
xlab("")
ggplot( data.frame(df1$ln_birth_rate), aes(y=df1$ln_birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej ln_birth_rate") +
xlab("")
ggplot( data.frame(df1$birth_rate), aes(y=df1$birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej birth_rate") +
xlab("")
ggplot( data.frame(df1$ln_birth_rate), aes(y=df1$ln_birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej ln_birth_rate") +
xlab("")
par(mfrow=c(1,2))
boxplot_birth_rate <- ggplot( data.frame(df1$birth_rate), aes(y=df1$birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej birth_rate") +
xlab("")
boxplot_birth_rate
boxplot_ln_birth_rate <- ggplot( data.frame(df1$ln_birth_rate), aes(y=df1$ln_birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej ln_birth_rate") +
xlab("")
boxplot_ln_birth_rate
library(rcompanion)
par(mfrow=c(1,2))
plotNormalHistogram(df1$birth_rate, prob = FALSE,
main = "birth_rate and normal distribution",
linecol = "red",
length = 1000)
df1$ln_birth_rate = log(df1$birth_rate)
plotNormalHistogram(df1$ln_birth_rate, prob = FALSE,
main = "ln_birth_rate and normal distribution",
linecol = "red",
length = 1000)
ibrary("tseries")
jarque.bera.test(df1$birth_rate) #p-value < 0.05, I reject H0 about normal distribution of birth_rate
jarque.bera.test(df1$ln_birth_rate) #p-value > 0.05; no grounds for rejecting H0 about normal distribution of ln_birth_rate
summary(df1$birth_rate)
summary(df1$birth_rate)
install.packages("ggthemes")
library("ggthemes")
install.packages("ggthemes")
install.packages("ggthemes")
boxplot_birth_rate <- ggplot( data.frame(df1$birth_rate), aes(y=df1$birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej birth_rate") +
xlab("")
boxplot_birth_rate
boxplot_ln_birth_rate <- ggplot( data.frame(df1$ln_birth_rate), aes(y=df1$ln_birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej ln_birth_rate") +
xlab("")
boxplot_ln_birth_rate
boxplot_birth_rate <- ggplot( data.frame(df1$birth_rate), aes(y=df1$birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej birth_rate") +
xlab("")
boxplot_birth_rate <- ggplot( data.frame(df1$birth_rate), aes(y=df1$birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej birth_rate") +
xlab("")
boxplot_birth_rate
library("readxl")
library("sandwich")
library("knitr")
library("tidyverse")
boxplot_birth_rate <- ggplot( data.frame(df1$birth_rate), aes(y=df1$birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej birth_rate") +
xlab("")
boxplot_birth_rate
boxplot_ln_birth_rate <- ggplot( data.frame(df1$ln_birth_rate), aes(y=df1$ln_birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej ln_birth_rate") +
xlab("")
boxplot_ln_birth_rate
boxplot_birth_rate <- ggplot( data.frame(df1$birth_rate), aes(y=df1$birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej birth_rate") +
xlab("")
boxplot_birth_rate
boxplot_ln_birth_rate <- ggplot( data.frame(df1$ln_birth_rate), aes(y=df1$ln_birth_rate)) +
geom_boxplot() +
ggtitle("Przykład boxplotu zmiennej ln_birth_rate") +
xlab("")
boxplot_ln_birth_rate
boxplot_birth_rate <- ggplot( data.frame(df1$birth_rate), aes(y=df1$birth_rate)) +
geom_boxplot() +
ggtitle("Boxplot zmiennej birth_rate") +
xlab("")
boxplot_birth_rate
boxplot_ln_birth_rate <- ggplot( data.frame(df1$ln_birth_rate), aes(y=df1$ln_birth_rate)) +
geom_boxplot() +
ggtitle("Boxplot zmiennej ln_birth_rate") +
xlab("")
boxplot_ln_birth_rate
library("readxl")
library("sandwich")
library("knitr")
library("tidyverse")
options(scipen = 999)
#LOAD DATA
df <- read_excel("baza_ekon.xlsx")
#DELETE NA
df1<-na.omit(df)
df1$ln_birth_rate = log(df1$birth_rate)
library("tseries")
library(rcompanion)
library("ggthemes")
df1$nurseryxchildren=df1$nursery_places*df1$children
df1$education_expenditurexchildren=df1$education_expenditure*df1$children
df1$houses_area_pc_2 = df1$houses_area_pc**2
df1$avg_people_per_house_2 = df1$avg_people_per_house**2
df1$house_ratio_2 = df1$house_ratio**2
model1=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + ln_marriage_rate +
divorce_rate + budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
women_working + men_working + median_house_price + house_ratio + house_ratio_2 + houses_area_pc +
houses_area_pc_2 + avg_people_per_house +avg_people_per_house_2+ education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model1)
model1=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate +
divorce_rate + budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
women_working + men_working + median_house_price + house_ratio + house_ratio_2 + houses_area_pc +
houses_area_pc_2 + avg_people_per_house +avg_people_per_house_2+ education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model1)
library("lmtest")
library("foreign")
resettest(model1, power=2:3, type="fitted")
resettest(model1, power=2:3, type="regressor")
########################### VARIABLES CHECKING ###########################
#VARIABLE WOMEN_WORKING
plotNormalHistogram(df1$women_working, prob = FALSE,
main = "women_working and normal distribution",
linecol = "red",
length = 1000)
df1$ln_women_working = log(df1$women_working)
plotNormalHistogram(df1$ln_women_working, prob = FALSE,
main = "ln_women_working and normal distribution",
linecol = "red",
length = 1000)
jarque.bera.test(df1$women_working) #p-value < 0.05, I reject H0 about normal distribution
jarque.bera.test(df1$ln_women_working) #p-value > 0.05
##################################################################
########################### NEXT MODEL ###########################
#MODEL 2
model2=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate +
divorce_rate + budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
ln_women_working + men_working + median_house_price + house_ratio + house_ratio_2 + houses_area_pc +
houses_area_pc_2 + avg_people_per_house +avg_people_per_house_2+ education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model2)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 2
model2=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate +
divorce_rate + budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 + houses_area_pc +
houses_area_pc_2 + avg_people_per_house +avg_people_per_house_2+ education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model2)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 3 REMOVE WOMEN_WORKING
model3=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate +
divorce_rate + budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 + houses_area_pc +
houses_area_pc_2 + avg_people_per_house +avg_people_per_house_2+ education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model3)
df1$ln_covid19_quarantine = log(df1$covid19_quarantine)
jarque.bera.test(df1$covid19_quarantine) #p-value < 0.05, I reject H0 about normal distribution
jarque.bera.test(df1$ln_covid19_quarantine) #p-value < 0.05, so I reject H0 about normal distribution, but p-value is higher
##################################################################
########################### NEXT MODEL ###########################
#MODEL 3 LN_COVID19_QUARANTINE
model3=lm(ln_birth_rate~covid19_cases + covid19_deaths + ln_covid19_quarantine + marriage_rate +
divorce_rate + budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 + houses_area_pc +
houses_area_pc_2 + avg_people_per_house +avg_people_per_house_2+ education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 4 LN_COVID19_QUARANTINE
model4=lm(ln_birth_rate~covid19_cases + covid19_deaths + ln_covid19_quarantine + marriage_rate +
divorce_rate + budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 + houses_area_pc +
houses_area_pc_2 + avg_people_per_house +avg_people_per_house_2+ education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model4)
jarque.bera.test(df1$education_expenditure) #p-value < 0.05, I reject H0 about normal distribution
df1$ln_education_expenditure = log(df1$education_expenditure)
jarque.bera.test(df1$ln_education_expenditure) #p-value < 0.05
plotNormalHistogram(df1$education_expenditure, prob = FALSE,
main = "education_expenditure and normal distribution",
linecol = "red",
length = 1000)
plotNormalHistogram(df1$ln_education_expenditure, prob = FALSE,
main = "ln_education_expenditure and normal distribution",
linecol = "red",
length = 1000)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 5 LN_EDUCATION_EXPENDITURE
model5=lm(ln_birth_rate~covid19_cases + covid19_deaths + ln_covid19_quarantine + marriage_rate +
divorce_rate + budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 + houses_area_pc +
houses_area_pc_2 + avg_people_per_house +avg_people_per_house_2+ ln_education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model5)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 6 REMOVE HOUSES_AREA_PC_2
model6=lm(ln_birth_rate~covid19_cases + covid19_deaths + ln_covid19_quarantine + marriage_rate +
divorce_rate + budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 + houses_area_pc +
avg_people_per_house +avg_people_per_house_2+ ln_education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model6)
jarque.bera.test(df1$houses_area_pc) #p-value < 0.05, I reject H0 about normal distribution
df1$ln_houses_area_pc = log(df1$houses_area_pc)
jarque.bera.test(df1$ln_houses_area_pc) #p-value < 0.05
##################################################################
########################### NEXT MODEL ###########################
#MODEL 7 LN_HOUSES_AREA_PC
model7=lm(ln_birth_rate~covid19_cases + covid19_deaths + ln_covid19_quarantine + marriage_rate +
divorce_rate + budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 + ln_houses_area_pc +
avg_people_per_house +avg_people_per_house_2+ ln_education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model7)
df1$ln_budget_reve_pc = log(df1$budget_reve_pc)
jarque.bera.test(df1$budget_reve_pc) #p-value < 0.05, I reject H0 about normal distribution
jarque.bera.test(df1$ln_budget_reve_pc) #p-value <0.05
##################################################################
########################### NEXT MODEL ###########################
#MODEL 8 LN_BUDGET_REVE_PC
model8=lm(ln_birth_rate~covid19_cases + covid19_deaths + ln_covid19_quarantine + marriage_rate +
divorce_rate + ln_budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 + ln_houses_area_pc +
avg_people_per_house +avg_people_per_house_2+ ln_education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model8)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 9 REMOVE LN_HOUSES_AREA_PC
model9=lm(ln_birth_rate~covid19_cases + covid19_deaths + ln_covid19_quarantine + marriage_rate +
divorce_rate + ln_budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2+
avg_people_per_house +avg_people_per_house_2+ ln_education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model9)
df1$ln_femininity_ratio = log(df1$femininity_ratio)
jarque.bera.test(df1$femininity_ratio) #p-value < 0.05, I reject H0 about normal distribution
jarque.bera.test(df1$ln_femininity_ratio) #p-value <0.05, but higher than in previous case
##################################################################
########################### NEXT MODEL ###########################
#MODEL 10 LN_FEMININITY_RATIO
model10=lm(ln_birth_rate~covid19_cases + covid19_deaths + ln_covid19_quarantine + marriage_rate +
divorce_rate + ln_budget_reve_pc + unemployment_rate + women_reproductive + ln_femininity_ratio + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2+ ln_education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model10)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 11 REMOVE LN_FEMININITY_RATIO
model11=lm(ln_birth_rate~covid19_cases + covid19_deaths + ln_covid19_quarantine + marriage_rate +
divorce_rate + ln_budget_reve_pc + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2+ ln_education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model11)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 12 REMOVE LN_COVID19_QUARANTINE
model12=lm(ln_birth_rate~covid19_cases + covid19_deaths + marriage_rate +
divorce_rate + ln_budget_reve_pc + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2+ ln_education_expenditure + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model12)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 13 REMOVE LN_EDUCATION_EXPENDITURE
model13=lm(ln_birth_rate~covid19_cases + covid19_deaths + marriage_rate +
divorce_rate + ln_budget_reve_pc + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model13)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 13 REMOVE LN_BUDGET_REVE_PC
model13=lm(ln_birth_rate~covid19_cases + covid19_deaths + marriage_rate +
divorce_rate + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model13)
df1$ln_covid19_cases = log(df1$covid19_cases)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 14 LN_COVID19_CASES
model14=lm(ln_birth_rate~ln_covid19_cases + covid19_deaths + marriage_rate +
divorce_rate + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model14)
jarque.bera.test(df1$health_expenditure) #p-value < 0.05, I reject H0 about normal distribution
df1$ln_health_expenditure = log(df1$health_expenditure)
jarque.bera.test(df1$ln_health_expenditure) #p-value < 0.05
##################################################################
########################### NEXT MODEL ###########################
#MODEL 15 LN_HEALTH_EXPENDITURE
model15=lm(ln_birth_rate~ln_covid19_cases + covid19_deaths + marriage_rate +
divorce_rate + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 + ln_health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model15)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 16 REMOVE NURSERY_PLACES
model16=lm(ln_birth_rate~ln_covid19_cases + covid19_deaths + marriage_rate +
divorce_rate + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 + ln_health_expenditure +
social_expenditure + family_expenditure + children + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model16)
df1$ln_children = log(df1$children)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 17 REMOVE NURSERY_PLACES
model17=lm(ln_birth_rate~ln_covid19_cases + covid19_deaths + marriage_rate +
divorce_rate + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 + ln_health_expenditure +
social_expenditure + family_expenditure + ln_children + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model17)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 17 REMOVE CHILDREN
model17=lm(ln_birth_rate~ln_covid19_cases + covid19_deaths + marriage_rate +
divorce_rate + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 + ln_health_expenditure +
social_expenditure + family_expenditure + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model17)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 18 REMOVE LN_HEALTH_CHILDREN
model18=lm(ln_birth_rate~ln_covid19_cases + covid19_deaths + marriage_rate +
divorce_rate + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 +
social_expenditure + family_expenditure + doctors+ urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model18)
df1$ln_urbanisation_rate = log(df1$urbanisation_rate)
jarque.bera.test(df1$urbanisation_rate) #p-value < 0.05, but p-value is higher than in the next case
df1$ln_urbanisation_rate = log(df1$urbanisation_rate)
jarque.bera.test(df1$ln_urbanisation_rate) #p-value < 0.05
##################################################################
########################### NEXT MODEL ###########################
#MODEL 19 REMOVE LN_HEALTH_CHILDREN
model19=lm(ln_birth_rate~ln_covid19_cases + covid19_deaths + marriage_rate +
divorce_rate + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 +
social_expenditure + family_expenditure + doctors+ ln_urbanisation_rate +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model19)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 19 REMOVE URBANISATION RATE, because LN_URBANISATION_RATE is still varable with the highest p-value
model19=lm(ln_birth_rate~ln_covid19_cases + covid19_deaths + marriage_rate +
divorce_rate + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 +
social_expenditure + family_expenditure + doctors +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model19)
resettest(model19, power=2:3, type="fitted")
resettest(model19, power=2:3, type="regressor")
resettest(model19, power=2, type="regressor")
resettest(model19, power=2, type="fitted")
bptest(model3, studentize=TRUE)
jarque.bera.test(model3$residuals)
bptest(model19, studentize=TRUE)
jarque.bera.test(model19$residuals)
dwtest(model19)
#breuscha godfreya
bgtest(model19)
#durbin watson
durbinWatsonTest(model19)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 19 REMOVE URBANISATION RATE, because LN_URBANISATION_RATE is still varable with the highest p-value
model19=lm(ln_birth_rate~ln_covid19_cases + covid19_deaths + marriage_rate +
divorce_rate + unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 +
social_expenditure + family_expenditure + doctors +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model19)
#LEVERAGE
# u mnie obserwacja nietypowa to >= 2K/N, czyli 2*19/380 = 0.01
library("car")
leveragePlots(model19)
par(mfrow=c(1,1))
cutoff <- 4/((nrow(df1)))
plot(model19, which=4, cook.levels=cutoff)
#standaryzowane reszty (outliers)
# gsy ich wartosci >2 to obserwacje nietypowe
rstandard(model19)[abs(rstandard(model19)) > 2] # które obserwacje większe niż 2 co do wartosci bezwzglednej
#overfitting lub underfitting formy funkcyjnej
avPlots(model19)
vif(model19)
plot(model19,3)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 19 REMOVE URBANISATION RATE, because LN_URBANISATION_RATE is still varable with the highest p-value
model19=lm(ln_birth_rate~ln_covid19_cases + covid19_deaths + marriage_rate +
unemployment_rate + women_reproductive + avg_salary +
men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 +
social_expenditure + family_expenditure + doctors +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model19)
resettest(model19, power=2:3, type="fitted")
bptest(model19, studentize=TRUE)
jarque.bera.test(model19$residuals)
dwtest(model19)
##################################################################
########################### NEXT MODEL ###########################
#MODEL 19 REMOVE URBANISATION RATE, because LN_URBANISATION_RATE is still variable with the highest p-value
model19=lm(ln_birth_rate~ln_covid19_cases + covid19_deaths + marriage_rate + divorce_rate + unemployment_rate +
women_reproductive + avg_salary + men_working + median_house_price + house_ratio + house_ratio_2 +
avg_people_per_house +avg_people_per_house_2 + social_expenditure + family_expenditure + doctors +
bus_stops + nurseryxchildren + education_expenditurexchildren, data=df1)
summary(model19)
