yfit <- yfit * diff(h$mids[1:2]) * length(df1$birth_rate)
lines(xfit, yfit, col = "red", lwd = 2)
df1$ln_birth_rate = log(df1$birth_rate)
h <- hist(df1$ln_birth_rate)
xfit <- seq(min(df1$ln_birth_rate), max(df1$ln_birth_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$ln_birth_rate), sd = sd(df1$ln_birth_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$ln_birth_rate)
lines(xfit, yfit, col = "red", lwd = 2)
hist(df1$marriage_rate) #marriage_rate without log appears to have a distribution more similar to the normal distribution
df1$ln_marriage_rate = log(df1$marriage_rate)
hist(df1$ln_marriage_rate)
g_marriage<-ggplot(df1, aes(x=birth_rate, y=marriage_rate)) +geom_point(color="red")
g_marriage
#UNEMPLOYMENT RATE
hist(df1$unemployment_rate)
df1$ln_unemployment_rate = log(df1$unemployment_rate)
hist(df1$ln_unemployment_rate) #log from unemployment_rate looks better
h <- hist(df1$unemployment_rate)
xfit <- seq(min(df1$unemployment_rate), max(df1$unemployment_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$unemployment_rate), sd = sd(df1$unemployment_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$unemployment_rate)
lines(xfit, yfit, col = "red", lwd = 2)
h <- hist(df1$ln_unemployment_rate)
xfit <- seq(min(df1$ln_unemployment_rate), max(df1$ln_unemployment_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$ln_unemployment_rate), sd = sd(df1$ln_unemployment_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$ln_unemployment_rate)
lines(xfit, yfit, col = "red", lwd = 2)
g_unemployment<-ggplot(df1, aes(x=birth_rate, y=unemployment_rate)) + geom_point(color="red")
g_unemployment
g_ln_unemployment<-ggplot(df1, aes(x=birth_rate, y=ln_unemployment_rate)) + geom_point(color="red")
g_ln_unemployment
hist(df1$avg_salary)
hist(df1$ln_avg_salary) #log from avg_salary looks better
hist(df1$ln_avg_salary) #log from avg_salary looks better
df1$ln_avg_salary = log(df1$avg_salary)
hist(df1$avg_salary)
hist(df1$ln_avg_salary) #log from avg_salary looks better
hist(df1$avg_salary)
#INTERACTION
df1$nurseryxchildren=df1$nursery_places*df1$children
df1$education_expenditurexpopulation=df1$education_expenditure*df1$population
df1$women_working
df1$women_workingxurbanisation_rate = df1$women_working*df1$urbanisation_rate
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren + education_expenditurexludnosc+women_workingxurbanisation_rate, data=df1)
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren + education_expenditurexpopulation+women_workingxurbanisation_rate, data=df1)
summary(model1)
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren + education_expenditurexpopulation, data=df1)
summary(model1)
resettest(model1, power=2:3, type="fitted")
df1$education_expenditurexchildren=df1$education_expenditure*df1$children
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren + education_expenditurexpopulation +education_expenditurexchildren, data=df1)
summary(model1)
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren  +education_expenditurexchildren, data=df1)
summary(model1)
df1$urbanisation_rate_2 = df1$urbanisation_rate*df1$urbanisation_rate
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate_2 + bus_stops + nurseryxchildren  +education_expenditurexchildren, data=df1)
summary(model1)
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate +urbanisation_rate_2 + bus_stops + nurseryxchildren  +education_expenditurexchildren, data=df1)
summary(model1)
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren  +education_expenditurexchildren +population, data=df1)
summary(model1)
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren  +education_expenditurexchildren +population + I(population^2), data=df1)
summary(model1)
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren  +education_expenditurexchildren +population + kobiety + I(kobiety^2), data=df1)
summary(model1)
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working + I(women_working^2)
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren  +education_expenditurexchildren +population , data=df1)
summary(model1)
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working + I(women_working^2)+
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren  +education_expenditurexchildren +population , data=df1)
summary(model1)
model1=lm(ln_birth_rate~if_university + covid19_cases + I(covid19_cases^2) + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren  +education_expenditurexchildren +population , data=df1)
summary(model1)
pairs(dane[,5:10])
pairs(df1[,5:10])
library(corrplot)
kor<-cor(df1)
corrplot(kor, method="circle")
#loading data
df <- read_excel("baza_ekon.xlsx")
#delete NA
df1<-na.omit(df)
str(df1) #types of variables
pairs(df1[,5:10])
pairs(df1[,:10])
pairs(df1[,0:10])
library(corrplot)
kor<-cor(df1)
corrplot(kor, method="circle")
#loading data
df <- read_excel("baza_ekon.xlsx")
#delete NA
df1<-na.omit(df)
pairs(df1[,0:10])
#delete NA
df1<-na.omit(df)
#loading data
df <- read_excel("baza_ekon.xlsx")
#delete NA
df1<-na.omit(df)
library(corrplot)
kor<-cor(df1)
corrplot(kor, method="circle")
h <- hist(df1$birth_rate)
xfit <- seq(min(df1$birth_rate), max(df1$birth_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$birth_rate), sd = sd(df1$birth_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$birth_rate)
lines(xfit, yfit, col = "red", lwd = 2)
df1$ln_birth_rate = log(df1$birth_rate)
h <- hist(df1$ln_birth_rate)
xfit <- seq(min(df1$ln_birth_rate), max(df1$ln_birth_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$ln_birth_rate), sd = sd(df1$ln_birth_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$ln_birth_rate)
lines(xfit, yfit, col = "red", lwd = 2)
#VARIABLE MARRIAGE RATE
hist(df1$marriage_rate) #marriage_rate without log appears to have a distribution more similar to the normal distribution
df1$ln_marriage_rate = log(df1$marriage_rate)
hist(df1$ln_marriage_rate)
g_marriage<-ggplot(df1, aes(x=birth_rate, y=marriage_rate)) +geom_point(color="red")
g_marriage
#UNEMPLOYMENT RATE
hist(df1$unemployment_rate)
df1$ln_unemployment_rate = log(df1$unemployment_rate)
hist(df1$ln_unemployment_rate) #log from unemployment_rate looks better
h <- hist(df1$unemployment_rate)
xfit <- seq(min(df1$unemployment_rate), max(df1$unemployment_rate), length = 40)
hist(df1$ln_unemployment_rate) #log from unemployment_rate looks better
h <- hist(df1$unemployment_rate)
xfit <- seq(min(df1$unemployment_rate), max(df1$unemployment_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$unemployment_rate), sd = sd(df1$unemployment_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$unemployment_rate)
lines(xfit, yfit, col = "red", lwd = 2)
h <- hist(df1$ln_unemployment_rate)
xfit <- seq(min(df1$ln_unemployment_rate), max(df1$ln_unemployment_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$ln_unemployment_rate), sd = sd(df1$ln_unemployment_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$ln_unemployment_rate)
lines(xfit, yfit, col = "red", lwd = 2)
g_unemployment<-ggplot(df1, aes(x=birth_rate, y=unemployment_rate)) + geom_point(color="red")
g_unemployment
g_ln_unemployment<-ggplot(df1, aes(x=birth_rate, y=ln_unemployment_rate)) + geom_point(color="red")
g_ln_unemployment
#AVERAGE SALARY
g_avg_salary<-ggplot(df1, aes(x=birth_rate, y=avg_salary)) + geom_point(color="red")
g_avg_salary
df1$ln_avg_salary = log(df1$avg_salary)
hist(df1$avg_salary)
hist(df1$ln_avg_salary) #log from avg_salary looks better
g_ln_avg_salary<-ggplot(df1, aes(x=birth_rate, y=ln_avg_salary)) + geom_point(color="red")
g_ln_avg_salary
#INTERACTION
df1$nurseryxchildren=df1$nursery_places*df1$children
df1$education_expenditurexchildren=df1$education_expenditure*df1$children
df1$urbanisation_rate_2 = df1$urbanisation_rate*df1$urbanisation_rate
model1=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren  +education_expenditurexchildren +population , data=df1)
model1=lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops , data=df1)
summary(model1)
resettest(model1, power=2:3, type="fitted")
model1=lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops , data=df1)
summary(model1)
library("readxl")
library("lmtest")
library("sandwich")
library("knitr")
library("tidyverse")
library("lmtest")
library("foreign")
options(scipen = 999)
#loading data
df <- read_excel("baza_ekon.xlsx")
#delete NA
df1<-na.omit(df)
#DEPENDENT VARIABLE - BIRTH RATE
par(mfrow=c(1,2))
h <- hist(df1$birth_rate)
xfit <- seq(min(df1$birth_rate), max(df1$birth_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$birth_rate), sd = sd(df1$birth_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$birth_rate)
lines(xfit, yfit, col = "red", lwd = 2)
df1$ln_birth_rate = log(df1$birth_rate)
h <- hist(df1$ln_birth_rate)
xfit <- seq(min(df1$ln_birth_rate), max(df1$ln_birth_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$ln_birth_rate), sd = sd(df1$ln_birth_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$ln_birth_rate)
lines(xfit, yfit, col = "red", lwd = 2)
model1=lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops , data=df1)
summary(model1)
model1=lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops, data=df1)
summary(model1)
#MODEL 1
model1=lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops, data=df1)
#MODEL 1
model1=lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops, data=df1)
model1=lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops, data=df1)
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops, data=df1)
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops data=df1)
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops; data=df1)
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops, data=df1)
summary(model1)
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops, data=df1)
summary(model1)
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors +
family_benefits + urbanisation_rate + bus_stops, data=df1)
summary(model1)
#test reset
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
Social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors+
family_benefits + urbanisation_rate + bus_stops, data=df1)
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +Social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors+
family_benefits + urbanisation_rate + bus_stops, data=df1)
summary(model1)
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +Social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors+family_benefits + urbanisation_rate + bus_stops, data=df1)
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate + budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +Social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors+family_benefits + urbanisation_rate + bus_stops, data=df1)
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
Social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors+
family_benefits + urbanisation_rate + bus_stops, data=df1)
summary(model1)
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
Social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors+
family_benefits + urbanisation_rate + bus_stops data=df1)
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
Social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors+
family_benefits + urbanisation_rate + bus_stops, data=df1)
#MODEL 2
model2=lm(ln_birth_rate~if_university + covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + ln_divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren, data=df1)
model2=lm(ln_birth_rate~Covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + ln_divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren, data=df1)
summary(model2)
model2=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + ln_divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren, data=df1)
summary(model2)
#MODEL 2
model2=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + ln_unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren, data=df1)
#MODEL 2
model2=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops + nurseryxchildren, data=df1)
#MODEL 2
model2=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
women_working_all + median_house_price + house_ratio + education_expenditure + health_expenditure + social_expenditure +
family_expenditure + doctors + urbanisation_rate + bus_stops, data=df1)
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc, data=df1)
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working, data=df1)
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
Social_expenditure, data=df1)
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
social_expenditure, data=df1)
#MODEL 1
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio, data=df1)
library("readxl")
library("lmtest")
library("sandwich")
library("knitr")
library("tidyverse")
library("lmtest")
library("foreign")
library("readxl")
library("lmtest")
library("sandwich")
library("knitr")
library("tidyverse")
library("lmtest")
library("foreign")
options(scipen = 999)
#loading data
df <- read_excel("baza_ekon.xlsx")
#delete NA
df1<-na.omit(df)
h <- hist(df1$irth_rate)
xfit <- seq(min(df1$birth_rate), max(df1$birth_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$birth_rate), sd = sd(df1$birth_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$birth_rate)
lines(xfit, yfit, col = "red", lwd = 2)
df1$ln_birth_rate = log(df1$birth_rate)
h <- hist(df1$ln_birth_rate)
xfit <- seq(min(df1$ln_birth_rate), max(df1$ln_birth_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$ln_birth_rate), sd = sd(df1$ln_birth_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$ln_birth_rate)
lines(xfit, yfit, col = "red", lwd = 2)
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure +
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors+
family_benefits + urbanisation_rate + bus_stops, data=df1)
summary(model1)
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure+
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors+
family_benefits + urbanisation_rate + bus_stops, data=df1)
summary(model1)
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure+
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors+
family_benefits + urbanisation_rate + bus_stops, data=df1)
summary(model1)
model1 = lm(ln_birth_rate~ covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working + women_working_all men_working_all + median_house_price + house_ratio + health_expenditure+
social_expenditure + family_expenditure + children + nursery_places + population + men + women + doctors+
family_benefits + urbanisation_rate + bus_stops, data=df1)
summary(model1)
model1=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working+women_working_all+men_working_all + median_house_price + house_ratio + education_expenditure + health_expenditure + social_expenditure +
family_expenditure +children+nursery_places+ doctors+family_benefits +population+houses+houses_area+ urbanisation_rate + bus_stops, data=df1)
summary(model1)
#test reset
resettest(model1, power=2:3, type="fitted")
#loading data
df <- read_excel("baza_ekon.xlsx")
#delete NA
df1<-na.omit(df)
#DEPENDENT VARIABLE - BIRTH RATE
par(mfrow=c(1,2))
h <- hist(df1$irth_rate)
xfit <- seq(min(df1$birth_rate), max(df1$birth_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$birth_rate), sd = sd(df1$birth_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$birth_rate)
lines(xfit, yfit, col = "red", lwd = 2)
df1$ln_birth_rate = log(df1$birth_rate)
h <- hist(df1$ln_birth_rate)
xfit <- seq(min(df1$ln_birth_rate), max(df1$ln_birth_rate), length = 40)
yfit <- dnorm(xfit, mean = mean(df1$ln_birth_rate), sd = sd(df1$ln_birth_rate))
yfit <- yfit * diff(h$mids[1:2]) * length(df1$ln_birth_rate)
lines(xfit, yfit, col = "red", lwd = 2)
#MODEL 1
model1=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working+ median_house_price + house_ratio + education_expenditure + health_expenditure + social_expenditure +
family_expenditure +children+nursery_places+ doctors+family_benefits +population+houses+houses_area+ urbanisation_rate + bus_stops, data=df1)
summary(model1)
#loading data
df <- read_excel("baza_ekon.xlsx")
#delete NA
df1<-na.omit(df)
model1=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working+ median_house_price + education_expenditure + health_expenditure + social_expenditure +
family_expenditure +children+nursery_places+ doctors+family_benefits +population+houses+houses_area+ urbanisation_rate + bus_stops, data=df1)
summary(model1)
#loading data
df <- read_excel("baza_ekon.xlsx")
#delete NA
df1<-na.omit(df)
model1=lm(ln_birth_rate~covid19_cases + covid19_deaths + covid19_quarantine + marriage_rate + divorce_rate +
budget_reve_pc + unemployment_rate + women_reproductive + femininity_ratio + avg_salary + women_working +
men_working+ median_house_price + education_expenditure + health_expenditure + social_expenditure +
family_expenditure +children+nursery_places+ doctors+family_benefits +population+houses+houses_area+ urbanisation_rate + bus_stops, data=df1)
summary(model1)
#loading data
df <- read_excel("baza_ekon.xlsx")
library("readxl")
library("lmtest")
library("sandwich")
library("knitr")
library("tidyverse")
library("lmtest")
library("foreign")
options(scipen = 999)
#loading data
df <- read_excel("baza_ekon.xlsx")
View(df)
#loading data
df <- read_excel("baza_ekon.xlsx")
View(df)
library("readxl")
library("lmtest")
library("sandwich")
library("knitr")
library("tidyverse")
library("lmtest")
library("foreign")
options(scipen = 999)
#loading data
df <- read_excel("baza_ekon.xlsx")
